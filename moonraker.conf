# ==============================================================================
# Moonraker Update Manager Configuration
# Klipper Toolchanger Extended
# ==============================================================================
#
# Add this section to your moonraker.conf to enable automatic updates
# via the Moonraker update manager.
#
# Location: ~/printer_data/config/moonraker.conf
#
# After adding this configuration, restart Moonraker:
#   sudo systemctl restart moonraker
#
# ==============================================================================

[update_manager klipper-toolchanger-extended]
type: git_repo
path: ~/klipper-toolchanger-extended
origin: https://github.com/PrintStructor/klipper-toolchanger-extended.git
primary_branch: main
managed_services: klipper
install_script: install.sh

# ==============================================================================
# Configuration Options Explained
# ==============================================================================
#
# type: git_repo
#   - Tells Moonraker this is a Git repository
#
# path: ~/klipper-toolchanger-extended
#   - Local path where the repository is cloned
#   - Adjust if you installed to a different location
#
# origin: https://github.com/PrintStructor/klipper-toolchanger-extended.git
#   - GitHub repository URL
#   - Used to fetch updates
#
# primary_branch: main
#   - The main branch to track for updates
#   - Change to 'develop' if you want to test beta features
#
# managed_services: klipper
#   - Services to restart after updates
#   - Klipper will automatically restart after updating Python modules
#
# install_script: install.sh
#   - Script to run after updates
#   - Ensures Python modules are properly linked
#
# ==============================================================================
# Alternative Configuration (For Development/Beta Testing)
# ==============================================================================
#
# If you want to track the development branch for early access to features:
#
# [update_manager klipper-toolchanger-extended]
# type: git_repo
# path: ~/klipper-toolchanger-extended
# origin: https://github.com/PrintStructor/klipper-toolchanger-extended.git
# primary_branch: develop
# managed_services: klipper
# install_script: install.sh
#
# ==============================================================================
# Troubleshooting
# ==============================================================================
#
# If updates fail:
#
# 1. Check Moonraker logs:
#    tail -f ~/printer_data/logs/moonraker.log
#
# 2. Verify repository is clean:
#    cd ~/klipper-toolchanger-extended
#    git status
#
# 3. If you have local modifications, stash them:
#    git stash
#    git pull
#
# 4. Manually re-run install script:
#    cd ~/klipper-toolchanger-extended
#    ./install.sh
#
# 5. Restart services:
#    sudo systemctl restart klipper
#    sudo systemctl restart moonraker
#
# ==============================================================================
# Notes
# ==============================================================================
#
# - Updates are checked automatically by Moonraker (default: every 24 hours)
# - You can manually check for updates via Mainsail/Fluidd UI
# - Always backup your configuration before updating
# - Read the CHANGELOG.md before updating to review changes
# - If update breaks something, you can rollback:
#     cd ~/klipper-toolchanger-extended
#     git log  # Find previous commit hash
#     git checkout <commit-hash>
#     ./install.sh
#     sudo systemctl restart klipper
#
# ==============================================================================
